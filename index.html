<!DOCTYPE html>
<html>
  <title>ELEMENTS</title>
<body style="background-color:#6699cc;">

<h1 style="text-align: center;"><span style="font-size:26px;">Array Of byte</span></h1>

  <p style="text-align: center;"><span style="font-size:24px;"><a href="" target="_blank"></a>...............................</span></p>




[ENABLE]
aobscanmodule(healthBarsModifier,RDR2.exe,41 8B C2 49 FF C2) // should be unique
alloc(newmem,$200)

label(code)
label(return barsToSet)
label(bModTotalBars bModSetMaxQuant)
newmem:
  pop rax
  //Write your code here:
  mov rax,[r11+58]
  test rax,rax
  jz code ///not player
  mov al,[bModTotalBars]
  test al,al
  jz skip1
  call setTotalBars
  skip1:
  mov al,[bModSetMaxQuant]
  test al,al
  jz code
  call decryptSetNEncrypt
code:
  //readmem(healthBarsModifier,15)
  mov eax,r10d
  inc r10
  lea r8,[rax+rax*2]
  mov edx,[r11+r8*8+0C]
  jmp return
setTotalBars:
  mov eax,[barsToSet]
  mov [r11+188],eax
  ret

decryptSetNEncrypt:
  enter 0,0
  //Free Regs: R8,RAX,RDX,RCX
  //Decryption
  mov eax,r10d
  lea r8,[rax+rax*2]
  mov ecx,[r11+r8*8+14]
  ror ecx,3
  rol ecx,10
  mov edx,[r11+r8*8+10]
  xor edx,ecx
  //mov eax,ecx
  rol edx,10
  and ecx,F
  add ecx,5
  rol edx,cl
  not edx
  //Evaluation
  test edx,edx
  jnz @f
  //if still 0 then
  mov rdx,[r11+10]//1st Base
  mov [r11+r8*8+10],rdx
  @@:
  //Encryption
  not edx
  mov r8d,[r11+r8*8+0C]
  rol r8d,10
  ror r8d,4
  mov ecx,r8d
  and ecx,F
  add ecx,4
  ror edx,cl
  ror edx,10
  xor edx,r8d
  mov eax,r10d
  lea r8,[rax+rax*2]
  mov [r11+r8*8+08],edx
  leave
  ret
align 10,90
  barsToSet:
    dq #9
  bModTotalBars:
    db 0
  bModSetMaxQuant:
    db 0

healthBarsModifier:
  push rax
  mov rax,newmem
  jmp rax
  nop 2
  return:
registersymbol(healthBarsModifier barsToSet bModTotalBars bModSetMaxQuant)

[DISABLE]

healthBarsModifier:
  db 41 8B C2 49 FF C2 4C 8D 04 40 43 8B 54 C3 0C 

unregistersymbol(healthBarsModifier barsToSet bModTotalBars bModSetMaxQuant)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: RDR2.exe+18B24B

RDR2.exe+18B23F: 49 8B DA           - mov rbx,r10
RDR2.exe+18B242: 48 85 DB           - test rbx,rbx
RDR2.exe+18B245: 0F 84 B0 00 00 00  - je RDR2.exe+18B2FB
// ---------- INJECTING HERE ----------
RDR2.exe+18B24B: 41 8B C2           - mov eax,r10d
// ---------- DONE INJECTING  ----------
RDR2.exe+18B24E: 49 FF C2           - inc r10
RDR2.exe+18B251: 4C 8D 04 40        - lea r8,[rax+rax*2]
RDR2.exe+18B255: 43 8B 54 C3 0C     - mov edx,[r11+r8*8+0C]
}

  
  
 
</body>
</html>
